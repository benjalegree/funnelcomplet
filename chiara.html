<!doctype html>
<html lang="es">
<meta charset="utf-8">
<title>Tester CRM Sheets</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<body style="font:15px/1.4 system-ui,Segoe UI,Roboto,Helvetica,Arial;padding:24px;background:#f8fafc;color:#0b1220">
<h1 style="margin:0 0 12px">Tester — Alta de lead</h1>
<p style="margin:0 0 16px">Envía un lead de prueba a tu API (Google Apps Script + Sheets).</p>

<form id="f" style="display:grid;gap:10px;max-width:520px;background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:16px">
  <label>Email <input name="email" type="email" required placeholder="test@example.com" style="width:100%"></label>
  <label>Project slug <input name="project_slug" required placeholder="mi-landing-slug" style="width:100%"></label>
  <label>Nombre (opcional) <input name="name" placeholder="Nombre" style="width:100%"></label>
  <label>Teléfono (opcional) <input name="phone" placeholder="+34 600 000 000" style="width:100%"></label>
  <button type="submit" style="padding:10px 14px;border:0;border-radius:10px;background:#0b5fff;color:#fff;font-weight:800">Enviar</button>
</form>

<pre id="out" style="margin-top:16px;white-space:pre-wrap;background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:14px"></pre>

<script>
const ENDPOINT = "https://script.google.com/macros/s/AKfycbxe8mPiH2ToslKtQqM-JyuZzZuJQGgkPEF0_6Vk4evQ2-FMTW-g-qWRr3d0YNz8_v3dVw/exec";
const API_KEY  = "pon-un-secreto-simple-aqui"; // ← ya puesta

const f = document.getElementById('f');
const out = document.getElementById('out');

f.addEventListener('submit', async (e)=>{
  e.preventDefault();
  const data = Object.fromEntries(new FormData(f).entries());
  data.action = "upsert";
  data._key   = API_KEY;
  out.textContent = "Enviando…";
  try{
    const r = await fetch(ENDPOINT, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(data)
    });
    const txt = await r.text();
    out.textContent = txt;
  }catch(err){
    out.textContent = "Error de red: " + (err.message||String(err));
  }
});

// Atajo: probar listado (GET) con tu key
const listURL = `${ENDPOINT}?action=list&limit=5&key=${encodeURIComponent(API_KEY)}`;
out.insertAdjacentHTML('beforebegin', `<p style="margin:12px 0">Ver últimos 5 leads: <a href="${listURL}" target="_blank" rel="noopener">${listURL}</a></p>`);
</script>
</body>
</html>
