<!doctype html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Checklist de Productividad | funnels proooooooas</title>
  <style>
    :root {
      --primary: #00d5ff;
      --accent: #000000;
    }
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: system-ui, sans-serif; line-height:1.5; color: var(--accent); background: #fff; }
    .container { width:90%; max-width:800px; margin: auto; padding: 40px 0; }
    h1 { font-size:2rem; margin-bottom:16px; }
    p { margin-bottom:16px; }
    .btn-primary {
      display:inline-block; padding:16px 24px; background: var(--primary); color:#fff; text-decoration:none;
      border:none; border-radius:999px; font-size:1rem; font-weight:600;
    }
    section { padding:40px 0; }
    .benefits { display:flex; flex-wrap:wrap; gap:16px; justify-content:center; }
    .benefit-card {
      flex:1 1 220px; background:#f9f9f9; padding:24px; border-radius:8px; text-align:center;
    }
    .benefit-card h3 { margin-bottom:12px; font-size:1.25rem; }
    #leadform { padding:40px 0; }
    #faq details { margin-bottom:12px; }
    #faq summary {
      cursor:pointer; padding:12px; background:#f1f1f1; border-radius:4px; font-weight:600;
    }
    #faq p { padding:0 12px 12px; }
    footer { text-align:center; padding:20px 0; font-size:0.9rem; color:#666; }
    @media(max-width:600px){
      h1 { font-size:1.75rem; }
    }
  </style>
</head>
<body>
  <main class="container">
    <!-- Hero -->
    <section id="hero" aria-labelledby="hero-title">
      <h1 id="hero-title">Checklist esencial de productividad para consultores de funnels</h1>
      <p>Descubre los pasos clave para optimizar tu flujo de trabajo y maximizar tus resultados.</p>
      <a href="#leadform" class="btn-primary">Recibir mi checklist</a>
    </section>
    <!-- Benefits -->
    <section id="benefits" aria-labelledby="benefits-title">
      <h2 id="benefits-title" class="visually-hidden">Beneficios</h2>
      <div class="benefits">
        <div class="benefit-card">
          <h3>Optimiza tu tiempo</h3>
          <p>Reduce tareas repetitivas con procesos claros y eficientes.</p>
        </div>
        <div class="benefit-card">
          <h3>Mejora tu enfoque</h3>
          <p>Identifica y prioriza lo importante para avanzar sin distracciones.</p>
        </div>
        <div class="benefit-card">
          <h3>Aumenta conversiones</h3>
          <p>Aplica técnicas de productividad que impactan directamente tu funnel.</p>
        </div>
      </div>
    </section>
    <!-- Lead Form -->
    <section id="leadform" aria-labelledby="form-title">
      <h2 id="form-title" style="text-align:center; margin-bottom:24px;">Obtén tu checklist gratis</h2>
      <!-- BEGIN LEAD BLOCK (DO NOT EDIT) -->
<script>
  /* Plan C: slug incluso en preview (blob:/iframe) */
  window.__PSICO_SLUG = (typeof window.__PSICO_SLUG!=='undefined' && window.__PSICO_SLUG)
    ? window.__PSICO_SLUG
    : "";
</script>

<form id="leadForm" autocomplete="on">
  <label>Email</label>
  <input type="email" name="email" required placeholder="tu@correo.com">

  <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px">
    <div>
      <label>Nombre (opcional)</label>
      <input type="text" name="name" placeholder="Tu nombre">
    </div>
    <div>
      <label>Teléfono (opcional)</label>
      <input type="tel" name="phone" placeholder="+34 600 000 000">
    </div>
  </div>

  <!-- Slug mapeado directo desde el Webhook #1 -->
  <input type="hidden" name="project_slug" value="">
  <input type="hidden" name="page_url" value="">
  <input type="hidden" name="utm_source" value="">
  <input type="hidden" name="utm_medium" value="">
  <input type="hidden" name="utm_campaign" value="">
  <input type="hidden" name="utm_term" value="">
  <input type="hidden" name="utm_content" value="">

  <div style="margin-top:14px;display:flex;gap:10px;align-items:center;flex-wrap:wrap">
    <button type="submit" id="btnSubmit" style="padding:12px 16px;border-radius:999px;border:0;background:#0b5fff;color:#fff;font-weight:800;cursor:pointer">Recibir mi checklist</button>
    <span id="formMessage" style="color:#475569">—</span>
  </div>
</form>

<script>
(function(){
  const ENDPOINT = "https://script.google.com/macros/s/AKfycbzWAIlXAlJURfqDeUBgyFAeojocv-eciJ6FpVsS9lKbp_V5IsPwDTXQjLiTuxNie9taIg/exec";
  const API_KEY  = "pon-un-secreto-simple-aqui";

  const form = document.getElementById('leadForm');
  const msg  = document.getElementById('formMessage');
  const btn  = document.getElementById('btnSubmit');

  /* FIX: helper correcto (antes faltaban comillas y rompía el JS) */
  function looksLikeTpl(v){ return typeof v==='string' && v.includes(') && v.includes('); }

  // Completa page_url, UTM y asegura project_slug
  (function setParams(){
    const set = (n,v)=>{ const el=form.querySelector('[name="'+n+'"]'); if(el) el.value=v||''; };
    set('page_url', location.href);

    const q = new URLSearchParams(location.search);
    ['utm_source','utm_medium','utm_campaign','utm_term','utm_content'].forEach(k=> set(k, q.get(k)));

    const slugEl = form.querySelector('[name="project_slug"]');
    if (slugEl){
      // Si por alguna razón quedara la plantilla, usa URL o window.__PSICO_SLUG
      if (!slugEl.value || looksLikeTpl(slugEl.value)){
        const fromUrl  = q.get('project_slug') || q.get('slug') || '';
        let fromGlob   = (typeof window!=='undefined' && window.__PSICO_SLUG) ? String(window.__PSICO_SLUG) : '';
        if (looksLikeTpl(fromGlob)) fromGlob='';
        slugEl.value = fromUrl || fromGlob || '';
      }
    }
  })();

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();

    // No enviar si falta slug
    const slug = (form.querySelector('[name="project_slug"]')||{}).value || '';
    if(!slug){
      msg.textContent = "Error: falta project_slug (abre el enlace con ?project_slug=… o vuelve a generar la landing).";
      return;
    }

    msg.textContent = "Enviando…";
    const prev = btn.textContent;
    btn.disabled = true; btn.textContent = "Enviando…";

    const data = Object.fromEntries(new FormData(form).entries());
    data.action = "upsert";
    data._key   = API_KEY;

    try{
      const r = await fetch(ENDPOINT, {
        method:"POST",
        headers:{ "Content-Type":"text/plain;charset=UTF-8" }, // evita preflight CORS
        body: JSON.stringify(data)
      });
      const txt = await r.text();
      let json; try{ json = JSON.parse(txt); } catch(e){ throw new Error("Respuesta no JSON: "+txt.slice(0,160)); }

      if(json.ok){
        msg.textContent = "¡Listo! Revisa tu correo.";
        form.reset();
      } else {
        msg.textContent = "Error: " + (json.error || "Inténtalo de nuevo.");
        btn.disabled = false; btn.textContent = prev;
      }
    }catch(err){
      msg.textContent = "Error: " + (err.message || "Sin conexión.");
      btn.disabled = false; btn.textContent = prev;
    }
  });
})();
</script>
<!-- END LEAD BLOCK (DO NOT EDIT) -->
    </section>
    <!-- FAQ -->
    <section id="faq" aria-labelledby="faq-title">
      <h2 id="faq-title" style="margin-bottom:24px; text-align:center;">Preguntas frecuentes</h2>
      <details>
        <summary>¿Qué incluye el checklist?</summary>
        <p>Una lista paso a paso para optimizar tu productividad en la creación y gestión de funnels.</p>
      </details>
      <details>
        <summary>¿Cómo recibo el checklist?</summary>
        <p>Lo enviaremos al correo que proporciones inmediatamente después de registrarte.</p>
      </details>
      <details>
        <summary>¿Es realmente gratis?</summary>
        <p>Sí, es una guía gratuita sin compromiso de compra.</p>
      </details>
      <details>
        <summary>¿Puedo aplicar los consejos en cualquier tipo de funnel?</summary>
        <p>Claro, las recomendaciones son universales y se adaptan a distintos nichos y objetivos.</p>
      </details>
    </section>
  </main>
  <footer>
    <p>© 2025 funnels proooooooas</p>
  </footer>
</body>
</html>
